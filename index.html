<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="./css/style.css" rel="stylesheet" type="text/css" />
  <!-- <script src="./js/rem.js"></script> -->
  <title>绿地-空气质量在线监测平台</title>
</head>
<body>
  <div class="wrapper flex" id="app">
    <div class="content-top">
      <div class="logo"><img src="./imgs/logo.png" alt=""></div>
      <div class="content-left">
          <!-- <video width="100%" loop autoplay="autoplay" id="video">
            <source src="./imgs/video.mp4" type="video/mp4">
            Your browser does not support HTML5 video.
          </video> -->
          <video width="100%" loop autoplay="autoplay" id="video">
            <source :src="videoUrl" type="video/mp4">
            Your browser does not support HTML5 video.
          </video>
      </div>
    </div>
    <div class="content">
      <div class="name">
        <img src="./imgs/group.svg" alt="">
      </div>
      <div class="content-right">
        <ul class="list">
          <li class="item">
            <div class="title">
              <span class="title-cn">室  内</span>
              <span class="title-en">Indoor</span>
            </div>
            <span class="num" :class="[statusLevel]">25</span>
            <div class="info">
                <p class="info-data flex">
                  <span>温度<i class="humid">Temperature</i></span>
                  <span>77<i>&nbsp;℉</i></span>
                </p>
                <p class="info-data flex">
                  <span>湿度<i class="humid">Humidity</i></span>
                  <span>56<i>&nbsp;%</i></span>
                </p>
                <p class="info-data flex">
                  <span>CO<sub>2</sub></span>
                  <span>395<i>&nbsp;ppm</i></span>
                </p>
                <p class="info-data flex">
                  <span>TVOC</span>
                  <span>3<i>&nbsp;ppm</i></span>
                </p>
            </div>
          </li>
          <li class="item">
            <div class="title">
              <span class="title-cn">电 梯 厅</span>
              <span class="title-en">Elevator Hall</span>
            </div>
            <span class="num" :class="[statusLevel]">27</span>
            <div class="info">
                <p class="info-data flex">
                  <span>温度<i class="humid">Temperature</i></span>
                  <span>79<i>&nbsp;℉</i></span>
                </p>
                <p class="info-data flex">
                  <span>湿度<i class="humid">Humidity</i></span>
                  <span>55<i>&nbsp;%</i></span>
                </p>
                <p class="info-data flex">
                  <span>CO<sub>2</sub></span>
                  <span>380<i>&nbsp;ppm</i></span>
                </p>
                <p class="info-data flex">
                  <span>TVOC</span>
                  <span>3<i>&nbsp;ppm</i></span>
                </p>
            </div>
          </li>
          <li class="item">
            <div class="title">
              <span class="title-cn">室   外</span>
              <span class="title-en">Outdoor</span>
            </div>
            <span class="num" :class="[statusLevel]">{{ outdoorData.pm2_5 }}</span>
            <div class="info">
                <p class="info-data flex">
                  <span>温度<i class="humid">Temperature</i></span>
                  <span>{{ outdoorData.temperature }}<i>&nbsp;℉</i></span>
                </p>
                <p class="info-data flex">
                  <span>湿度<i class="humid">Humidity</i></span>
                  <span>{{ outdoorData.humidity }}<i>&nbsp;%</i></span>
                </p>
                <p class="info-data flex">
                  <span>PM2.5</span>
                  <span>{{ outdoorData.pm2_5 }}<i>&nbsp;μg/m³</i></span>
                </p>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    const WEATHER_URL = "http://aliv8.data.moji.com/whapi/json/aliweather/"
    const AXIOS_HEADERS = {
      "Authorization": "APPCODE 4d283daf5f35494ca99e0854f9974952",
      "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
      "Accept": "application/json",
      "X-Ca-Request-Mode": "debug",
      "X-Ca-Key": "25644678" 
    }
    const PARAMS = {
      "lat": "31.202777",
      "lon": "121.486655"
    }

    const vm = new Vue({
      el: '#app',
      data: {
        statusLevel: '',
        videoUrl: '',
        outdoorData: {
          temperature: '',
          humidity: '',
          pm2_5: ''
        }
      },
      mounted() {
        this.videoUrl = './imgs/video.mp4'
        this.getAqi()
        this.getCondition()
      },
      methods: {
        getAqi() {
          axios({
            url: WEATHER_URL + "aqi",
            method: "post",
            headers: AXIOS_HEADERS,
            params: {...PARAMS, "token": "6e9a127c311094245fc1b2aa6d0a54fd"}
          }).then(res => {
            console.log(res.data.data)
            this.outdoorData.pm2_5 = res.data.data.aqi.pm25

            const AQI = this.outdoorData.pm2_5

            if(AQI >= 0 && AQI <= 35) {
              this.statusLevel = 'status-lv1'
            } else if(AQI > 35 && AQI <= 75) {
              this.statusLevel = 'status-lv2'
            } else if(AQI > 75 && AQI <= 115) {
              this.statusLevel = 'status-lv3'
            } else if(AQI > 115 && AQI <= 150) {
              this.statusLevel = 'status-lv4'
            } else if(AQI > 150 && AQI <= 250) {
              this.statusLevel = 'status-lv5'
            } else if(AQI > 250) {
              this.statusLevel = 'status-lv6'
            }
          })
        },
        getCondition() {
          axios({
            url: WEATHER_URL + "condition",
            method: "post",
            headers: AXIOS_HEADERS,
            params: {...PARAMS, "token": "ff826c205f8f4a59701e64e9e64e01c4"}
          }).then(res => {
            console.log(res.data.data.condition)
            let { temp, humidity} = res.data.data.condition
            this.outdoorData.temperature = Math.round(32 + Number(temp)*1.8)
            this.outdoorData.humidity = humidity
          })
        }
      }
    })
  </script>
</body>
</html>